package ch.hftm.controls;

import java.util.List;

import org.bson.types.ObjectId;

import ch.hftm.entities.Zombie;

import jakarta.enterprise.context.ApplicationScoped;
import jakarta.inject.Inject;
import jakarta.transaction.Transactional;

@ApplicationScoped
public class ZombieService {
    @Inject ZombieRepository zombieRepository;

    public List<Zombie> getAllZombies(){
        return zombieRepository.listAll();
    }

    @Transactional
    public void setZombie(Zombie Zombie) {
        zombieRepository.persistOrUpdate(Zombie);
    }

    public Zombie getById(ObjectId id) {
        Zombie zombie = zombieRepository.findById(id);

        return zombie;
    }

    public Zombie getByZombie(Zombie zombie) {
        return zombieRepository.list(
            "macAddress = ?1 and os = ?2 and userRunning = ?3",
            zombie.macAddress, zombie.os, zombie.userRunning)
            .getFirst();
    }

    @Transactional
    public void deleteZombie(Zombie zombie) {
        zombieRepository.delete(zombie);
    }

    @Transactional
    public void clearAllZombies() {
        zombieRepository.deleteAll();
    }
}
