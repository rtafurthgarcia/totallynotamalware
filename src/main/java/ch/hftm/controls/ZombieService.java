package ch.hftm.controls;

import java.util.List;

import org.bson.types.ObjectId;

import ch.hftm.entities.Zombie;

import jakarta.enterprise.context.ApplicationScoped;
import jakarta.inject.Inject;
import jakarta.transaction.Transactional;

@ApplicationScoped
public class ZombieService {
    @Inject ZombieRepository ZombieRepository;

    public List<Zombie> getAllZombies(){
        return ZombieRepository.listAll();
    }

    @Transactional
    public void setZombie(Zombie Zombie) {
        ZombieRepository.persistOrUpdate(Zombie);
    }

    public Zombie getById(ObjectId id) {
        Zombie Zombie = ZombieRepository.findById(id);

        return Zombie;
    }

    public Zombie getByZombie(Zombie Zombie) {
        return ZombieRepository.list(
            "macAddress = ?1 and os = ?2 and userRunning = ?3",
            Zombie.macAddress, Zombie.os, Zombie.userRunning)
            .getFirst();
    }

    @Transactional
    public void deleteZombie(Zombie Zombie) {
        ZombieRepository.delete(Zombie);
    }

    @Transactional
    public void clearAllZombies() {
        ZombieRepository.deleteAll();
    }
}
