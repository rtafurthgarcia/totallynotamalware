package ch.hftm.controls;

import java.util.List;

import org.bson.types.ObjectId;

import ch.hftm.entities.Computer;

import jakarta.enterprise.context.ApplicationScoped;
import jakarta.inject.Inject;
import jakarta.transaction.Transactional;

@ApplicationScoped
public class ComputerService {
    @Inject ComputerRepository computerRepository;

    public List<Computer> getAllComputers(){
        return computerRepository.listAll();
    }

    @Transactional
    public void setComputer(Computer computer) {
        computerRepository.persistOrUpdate(computer);
    }

    public Computer getById(ObjectId id) {
        Computer computer = computerRepository.findById(id);

        return computer;
    }

    public Computer getByComputer(Computer computer) {
        return computerRepository.list(
            "macAddress = ?1 and os = ?2 and userRunning = ?3",
            computer.macAddress, computer.os, computer.userRunning)
            .getFirst();
    }

    @Transactional
    public void deleteComputer(Computer computer) {
        computerRepository.delete(computer);
    }

    @Transactional
    public void clearAllComputers() {
        computerRepository.deleteAll();
    }
}
